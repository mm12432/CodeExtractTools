# Code Extract Tools V3

![软件截图](./V3.png)

这是一个专为软件著作权（软著）申请设计的原生辅助工具，用于快速从庞大的项目源码中提取、深度清洗并生成出符合送审标准的源代码文档。

本工具最初版本基于 Python 编写，后续重构为 Rust + Slint。随着功能的增多与排版定制的需求，当前的 **V3 版本全面演化为 Tauri + React + WebUI 架构**。这使它既能利用现代化的前端组件库构建精美的响应式多栏界面，又能继续发挥 Rust 处理数十万行大文本文件、操作底层 I/O 的极限性能。

## 🎯 解决的问题 / 主要功能

在申请软著时，你需要提交前 30 页和后 30 页（约 3000 行）连续、无空行、无大量注释的纯净源代码档案，且每页限制 50 行并附带固定带软件版本号的页眉与全局按序排列的页脚。

以前这些全靠手撸或者在 Word 里折腾半天。**有了这个工具，这一切压缩到只需鼠标点 3 下：**

1. **毫秒级全盘扫描与深度嗅探**：
   选择任意源码目录，自动根据 `.gitignore` 和您自定义的正则排除不需要的文件夹（如 `node_modules`）。最实在的是：工具会自动嗅探项目里的源码语种并提取出来。
2. **三效合一的强效净化**：
   - 自动干掉大段的无用代码注释
   - 自动干掉多余的换行符
   - 自动干掉大片的 import/include 声明头
   清洗全程配有实时的 Syntax Highlight 语法高亮预览供随时调整。
3. **原生精准 Docx 导出**：
   无需你亲自动手分页。填上“软件全称”和“版本号”，点击“生成软著标准文档”。后端强大的 `docx-rs` 会直接操作底层 XML 帮你织出一份严丝合缝、满版 50 行（超出限制自动帮你切出前1500行和后1500行合并）、首尾带页脚的高质量 `.docx` 文件。

## 🛠 技术栈

完全采用无 Node.js 后端服务、纯客户端构建方案：

* **Frontend**: React 18 + TypeScript + Vite + Material UI (MUI)
* **Backend**: Rust + Tauri 2.0 (采用高性能异步 IPC 通讯)
* **Core Libraries**: 
  * `ignore`: 原生文件遍历神器，速度极快
  * `docx-rs`: 脱离笨重的 MS Word 进程，直接从内存中装配二进制级 Word 文档

## 🚀 极速上手开发

```bash
# 1. 安装好 Rust 和 Node 之后，进入前端目录
cd code-extract-v3

# 2. 安装全部前端依赖
npm install

# 3. 开启全栈 Tauri 热更新开发模式
npm run tauri dev
```

## 📦 打包属于你的原生 EXE

```bash
npm run tauri build
```
执行完毕后，所有复杂页面与图片资源将被深度打包合并混淆注入二进制内部。您可在 `src-tauri/target/release` 中取得一个非常轻巧（约几 MB）、双击即用、且脱离任何环境独立运行的 `.exe` 可执行文件！
